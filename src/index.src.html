<html>
<head>
    <style>
        body {
            background: #ee6e73;
        }
        .section {
            padding: 20px;
        }
        #f_up_series_container, #f_down_series_container {
            cursor: pointer;
        }

        #f_up_series_container, #fibonacci_value, #f_down_series_container {
            text-align: center;
        }
        .container {
            background: #ffffff;
        }

    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Fibonacci Calculator</title>

    <!--Import Google Icon Font-->
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- build:css /css/site.css -->
    <link type="text/css" rel="stylesheet" href="../bower_components/Materialize/dist/css/materialize.min.css"
          media="screen,projection"/>
    <!-- endbuild -->

    <!-- build:js /js/site.js -->
    <script type="text/javascript" src="../bower_components/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="../bower_components/Materialize/dist/js/materialize.min.js"></script>
    <!-- endbuild -->

    <!--Let browser know website is optimized for mobile-->
    <script type="text/javascript">
        function NaN_to_Zero(value) {
            value = (isNaN(value)) ? 0 : value;
            value = (isFinite(value)) ? value : 0;
            return value;

        }

        $(document).ready(function () {
            var golden_number = 1.618;

            // Just make the first fibonacci calculation
            calculate_fibonacci();

            $('#fibonacci_value').keydown(function (e) {

                switch (e.which) {
                    case 38: // up
                        $('#fibonacci_value').val(Math.round($('#fibonacci_value').val() * golden_number));
                        calculate_fibonacci();
                        break;
                    case 40: // down
                        $('#fibonacci_value').val(Math.round($('#fibonacci_value').val() / golden_number));
                        calculate_fibonacci();
                        break;

                    default:
                        return; // exit this handler for other keys
                }
                e.preventDefault(); // prevent the default action (scroll / move caret)
            });

            $('#fibonacci_value').on('input', function () {
                // Just accept numbers
                this.value = this.value.replace(/[^0-9\.]/g, '');
                calculate_fibonacci();


            });
            $('#f_up_series_container, #f_down_series_container').click(function(e){
                $('#fibonacci_value').val(($(e.target).html()));
                calculate_fibonacci();
                e.stopPropagation();

            })


            $('#total_width').on('input', calculate_gutter);
            $('#column').on('input', calculate_gutter);
            $('#column_width').on('input', calculate_gutter);

            $('#gutter').on('input', calculate_column);
            $('#gutter_width').on('input', calculate_column);

            // Functions
            function calculate_gutter() {
                total_width = parseInt($('#total_width').val());
                column = parseFloat($('#column').val());

                column_width = parseInt($('#column_width').val());

                // Gutter
                gutter = column - 1;
                $('#gutter').val(NaN_to_Zero(parseInt(gutter)));

                // Gutter Width
                gutter_width = -((column * column_width) - total_width) / gutter;
                $('#gutter_width').val(NaN_to_Zero(gutter_width));
                //calculate_column();
            }

            function calculate_column() {
                total_width = parseInt($('#total_width').val());
                gutter = NaN_to_Zero(parseFloat($('#gutter').val()));
                gutter_width = parseFloat($('#gutter_width').val());

                column = gutter + 1;
                $('#column').val(parseInt(column));

                column_width = -((gutter_width * gutter) - total_width) / column;
                $('#column_width').val(NaN_to_Zero(column_width));

                $('#gutter').val(parseInt(gutter));


            }
            // Calculate de Fibonacci Serie
            function calculate_fibonacci() {
                var serie_length = 7;
                var original_value = $('#fibonacci_value').val();
                $("#f_down_series_container").empty();
                $("#f_up_series_container").empty();


                for (var i = 1; i <= serie_length; i++) {
                    secuence_value = Math.pow(golden_number, i);
                    $("#f_down_series_container").append("<div>" + Math.round(original_value / secuence_value) + "</div>");
                }

                for (var i = serie_length; i >= 1; i--) {
                    secuence_value = Math.pow(golden_number, i);
                    $("#f_up_series_container").append("<div>" + Math.round(original_value * secuence_value) + "</div>");
                }
            }
        });
    </script>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col s12 m12">
            <ul class="tabs">
                <li class="tab col s3"><a href="#f_tab">Fibonacci</a></li>
                <li class="tab col s3"><a href="#cg_tab">Gutter & Columns</a></li>
                <!--<li class="tab col s3"><a href="#calc">Calc</a></li>-->
            </ul>
            <div id="f_tab" class="col s12">
                <div class="section">
                    <div id="f_up_series_container"></div>
                    <input placeholder="" value="1" id="fibonacci_value" type="text">
                    <div id="f_down_series_container"></div>
                </div>

            </div>
            <div id="cg_tab" class="col s12">
                <div>
                    <label for="total_width">Total Wight</label><input id="total_width" type="text" value="1000"/>
                </div>
                <div>
                    <label for="column">Column</label><input id="column" type="text" value="10"/>
                </div>
                <div>
                    <label for="column_width">Column Width</label><input id="column_width" type="text" value="95.5"/>
                </div>
                <div>
                    <label for="gutter">Gutter</label><input id="gutter" type="text" value="9"/>
                </div>
                <div>
                    <label for="gutter_width">Gutter Width</label><input id="gutter_width" type="text" value="5" />
                </div>
                <div id="width_result"></div>
            </div>
            <!--<div id="calc" class="col s12">

                <input placeholder="" id="" type="text">
                <input placeholder="" id="" type="text">
            </div>-->
        </div>
    </div>
</div>
</body>
</html>